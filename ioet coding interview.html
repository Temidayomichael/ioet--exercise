<html>
	<head>
		<script type="text/javascript">
			fetch('data.txt')
				.then((response) => response.text())
				.then((data) => {
					var lines = data.split('\n')
					lines.map((line, key) => {
						document.write(calculateSalary(line) + '<br/>')
					})
				})
			// const line = prompt("Please input employee's name and schedule: ") // Get user input
			function calculateSalary(line) {
				let inputRegex =
					/^[a-zA-Z]+=((MO|TU|WE|TH|FR|SA|SU)(([0-1]?[0-9]|2[0-3]):[0-5][0-9])-(([0-1]?[0-9]|2[0-3]):[0-5][0-9]),?)+$/ // Regex to check if input is valid

				const weekdays = ['MO', 'TU', 'WE', 'TH', 'FR'] // Array of weekdays
				const weekends = ['SA', 'SU'] // Array of weekends

				const weekdaysPayPerHr = {
					A: {
						pay: '25',
						startTime: 0,
						endTime: 9.0,
					},
					B: {
						pay: '15',
						startTime: 9,
						endTime: 18.0,
					},
					C: {
						pay: '20',
						startTime: 18,
						endTime: 24.0,
					},
				}

				const weekendPayPerHr = {
					A: {
						pay: '30',
						startTime: 0.1,
						endTime: 9.0,
					},
					B: {
						pay: '20',
						startTime: 9,
						endTime: 18.0,
					},
					C: {
						pay: '25',
						startTime: 18,
						endTime: 24.0,
					},
				}

				const calculate = (startTime, endTime, payPerHr) => {
					if (startTime <= payPerHr.A.endTime) {
						if (endTime <= payPerHr.A.endTime) {
							hrsWorked = endTime - startTime
							return payPerHr.A.pay * hrsWorked
						} else if (endTime <= payPerHr.B.endTime) {
							hrsWorkedA = payPerHr.A.endTime - startTime
							hrsWorkedB = endTime - payPerHr.B.startTime
							let calculate =
								parseInt(hrsWorkedA * payPerHr.A.pay) +
								parseInt(hrsWorkedB * payPerHr.B.pay)

							return calculate
						} else if (endTime <= payPerHr.C.endTime) {
							hrsWorkedA = payPerHr.A.endTime - startTime
							hrsWorkedB = payPerHr.B.endTime - payPerHr.B.startTime
							hrsWorkedC = endTime - payPerHr.C.startTime

							return (
								parseInt(hrsWorkedA * payPerHr.A.pay) +
								parseInt(hrsWorkedB * payPerHr.B.pay) +
								parseInt(hrsWorkedC * payPerHr.C.pay)
							)
						}
					} else if (startTime <= payPerHr.B.endTime) {
						if (endTime <= payPerHr.B.endTime) {
							hrsWorkedB = endTime - startTime
							return parseInt(hrsWorkedB * payPerHr.B.pay)
						} else if (endTime <= payPerHr.C.endTime) {
							hrsWorkedB = payPerHr.B.endTime - payPerHr.B.startTime
							hrsWorkedC = endTime - payPerHr.C.startTime
							return (
								parseInt(hrsWorkedB * payPerHr.B.pay) +
								parseInt(hrsWorkedC * payPerHr.C.pay)
							)
						}
					} else if (startTime <= payPerHr.C.endTime) {
						if (endTime <= payPerHr.C.endTime) {
							hrsWorkedC = endTime - startTime
							return parseInt(hrsWorkedC * payPerHr.C.pay)
						}
					} else {
						return (calculatedSalary = 0)
					}
				}

				// If input is valid RENE=MO10:00-12:00,TU10:00-12:00,TH01:00-03:00,SA14:00-18:00,SU20:00-21:00
				if (inputRegex.test(line.trim())) {
					let empName = line.split('=')[0] // Get employee name
					let empSchedule = line.split('=')[1] // Get employee schedule
					let empScheduleArray = empSchedule.split(',') // Split schedule into array

					let totalSalary = 0 //

					for (let i = 0; i < empScheduleArray.length; i++) {
						let workDay = empScheduleArray[i].substring(0, 2) // Get employee schedule day
						let workTime = empScheduleArray[i].slice(2)
						let startTime = parseFloat(
							workTime.split('-')[0].replace(':', '.'),
						).toFixed(2)
						let endTime = parseFloat(
							workTime.split('-')[1].replace(':', '.'),
						).toFixed(2)

						let payPerHr = weekdays.includes(workDay)
							? weekdaysPayPerHr
							: weekendPayPerHr // Check if employee works on weekdays or weekends
						let payPerDay = 0 // Initialize pay per day
						let payPerHour = 0 // Initialize pay per hour

						let hrsWorked = 0

						let calculatedSalary = calculate(startTime, endTime, payPerHr)
						totalSalary += calculatedSalary

						// empScheduleObj['days'] = empScheduleTime // Add employee schedule to object
					}
					return `The amount to pay ${empName} is: ${totalSalary} USD`
				} else {
					return `Wrong format of input, ${line} must match the pattern ${inputRegex}`
				}
			}
		</script>
	</head>
	<body></body>
</html>
